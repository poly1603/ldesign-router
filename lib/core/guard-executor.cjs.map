{"version":3,"file":"guard-executor.cjs","sources":["../../src/core/guard-executor.ts"],"sourcesContent":[null],"names":["GuardExecutor","constructor","guards","Map","dependencyGraph","resultCache","CACHE_TTL","stats","totalExecutions","parallelExecutions","cacheHits","skipped","averageDuration","registerGuard","metadata","set","id","rebuildDependencyGraph","registerGuards","metadatas","unregisterGuard","delete","executeAll","to","from","startTime","performance","now","guardsToExecute","filterGuardsToExecute","length","undefined","executionPlan","buildExecutionPlan","results","batch","batchResults","executeBatch","push","abortResult","find","r","result","updateStats","values","skipCondition","cacheable","cacheKey","getCacheKey","cached","get","Date","timestamp","plan","remaining","Set","map","g","executed","size","guardId","node","dependenciesMet","Array","dependencies","every","dep","has","first","sort","a","b","priority","guard","add","promises","executeGuard","Promise","all","runGuard","duration","error","resolve","reject","resolved","next","Error","timeout","setTimeout","name","guardResult","then","clearTimeout","clear","dependents","depId","depNode","path","avgDuration","reduce","sum","getStats","registeredGuards","cacheSize","clearCache","resetStats","createGuardMetadata","options","Math","random","commonSkipConditions","samePath","sameQuery","JSON","stringify","query","sameParams","params","sameRoute"],"mappings":"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"}