{"version":3,"file":"state-integration.js","sources":["../../src/engine/state-integration.ts"],"sourcesContent":[null],"names":["RouterStateManager","constructor","stateManager","router","config","unsubscribers","enableHistory","maxHistoryLength","persistent","persistentKey","enableSync","initializeState","setupRouterListeners","setupStateSync","initialState","currentRoute","value","history","forwardHistory","isNavigating","error","isLoading","set","restorePersistedState","unsubscribeRoute","afterEach","to","from","updateCurrentRoute","addToHistory","setNavigating","clearError","unsubscribeBeforeEach","beforeEach","_to","_from","next","unsubscribeError","onError","setError","push","unsubscribe","subscribe","newState","persistState","route","currentHistory","get","newHistory","maxLength","length","splice","setLoading","state","persistentData","slice","timestamp","Date","now","localStorage","setItem","JSON","stringify","console","warn","getItem","data","parse","removeItem","Array","isArray","getState","getCurrentRoute","getHistory","getForwardHistory","canGoBack","canGoForward","goBack","previousRoute","goForward","nextRoute","clearHistory","destroy","forEach","remove","createRouterStateManager"],"mappings":"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"}